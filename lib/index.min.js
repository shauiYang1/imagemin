var version=function(t,e,o,n,r,s,a,u,i){"use strict";function p(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var c={name:"unexpected-stream",version:"5.1.0",installInto(t){t.addType({name:"Stream",base:"object",inspect(t,e,o,n){o.text(t.constructor&&t.constructor.name||"Stream","jsFunctionName")},identify:t=>t&&"function"==typeof t.on&&(t._readableState||"boolean"==typeof t.readable||"boolean"==typeof t.writable)}),t.addAssertion("<Stream|string|Buffer|array> [when] piped through <array|Stream> <assertion?>",((t,e,o)=>(t.errorMode="nested",t.promise(((n,r)=>{const s=Array.isArray(o)?o:[o];t(s,"not to be empty");const a=t.findTypeOf(e);let u;a.is("Stream")&&(u=e,e.on("error",r));const i=t.shift(s[s.length-1]);if(s.forEach((t=>{t.on("error",r),u=u?u.pipe(t):t})),!a.is("Stream"))try{(Array.isArray(e)?e:[e]).forEach((t=>{s[0].write(t)})),s[0].end()}catch(t){return r(t)}return n(i)})))));const e=new WeakMap;function o(o){let n=e.get(o);return n||(n=t.promise(((e,n)=>{t(o,"to have property","readable",!0);const r=[];o.on("data",(t=>{r.push(t)})).on("end",(()=>{e(r)})).on("error",n)})),e.set(o,n)),n}t.addAssertion(["<Stream> to yield (output|chunks|objects) satisfying <any+>","<Stream> to yield (output|chunks|objects) satisfying <assertion>"],(function(t,e,n){t.errorMode="nested";const r=Array.prototype.slice.call(arguments,2),s="output"===t.alternations[0];return t.promise(((t,n)=>{o(e).then((e=>{let o;o=s?e.length>0&&e.every((t=>"string"==typeof t))?e.join(""):Buffer.concat(e.map((t=>"string"==typeof t?Buffer.from?Buffer.from(t,"utf-8"):new Buffer(t,"utf-8"):t))):e,t(o)}),n)})).then((e=>t.apply(t,[e,"to satisfy assertion"].concat(r))))})),t.addAssertion("<Stream> to error",((t,e)=>o(e).then((()=>{t.fail(new Error("Stream was supposed to fail, but ended correctly"))}),(t=>t)))),t.addAssertion("<Stream> to error with <any>",((t,e,o)=>(t.errorMode="nested",t(e,"to error").then((e=>t(e,"to satisfy",o))))))}},l=p(c),f={};const A=i,R="\\\\/",h=`[^${R}]`,g="\\.",y="\\/",_="[^/]",E=`(?:${y}|$)`,b=`(?:^|${y})`,d=`${g}{1,2}${E}`,S={DOT_LITERAL:g,PLUS_LITERAL:"\\+",QMARK_LITERAL:"\\?",SLASH_LITERAL:y,ONE_CHAR:"(?=.)",QMARK:_,END_ANCHOR:E,DOTS_SLASH:d,NO_DOT:`(?!${g})`,NO_DOTS:`(?!${b}${d})`,NO_DOT_SLASH:`(?!${g}{0,1}${E})`,NO_DOTS_SLASH:`(?!${d})`,QMARK_NO_DOT:`[^.${y}]`,STAR:`${_}*?`,START_ANCHOR:b},$={...S,SLASH_LITERAL:`[${R}]`,QMARK:h,STAR:`${h}*?`,DOTS_SLASH:`${g}{1,2}(?:[${R}]|$)`,NO_DOT:`(?!${g})`,NO_DOTS:`(?!(?:^|[${R}])${g}{1,2}(?:[${R}]|$))`,NO_DOT_SLASH:`(?!${g}{0,1}(?:[${R}]|$))`,NO_DOTS_SLASH:`(?!${g}{1,2}(?:[${R}]|$))`,QMARK_NO_DOT:`[^.${R}]`,START_ANCHOR:`(?:^|[${R}])`,END_ANCHOR:`(?:[${R}]|$)`};var C={MAX_LENGTH:65536,POSIX_REGEX_SOURCE:{alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"},REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:A.sep,extglobChars:t=>({"!":{type:"negate",open:"(?:(?!(?:",close:`))${t.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}),globChars:t=>!0===t?$:S};!function(t){const e=i,o="win32"===process.platform,{REGEX_BACKSLASH:n,REGEX_REMOVE_BACKSLASH:r,REGEX_SPECIAL_CHARS:s,REGEX_SPECIAL_CHARS_GLOBAL:a}=C;t.isObject=t=>null!==t&&"object"==typeof t&&!Array.isArray(t),t.hasRegexChars=t=>s.test(t),t.isRegexChar=e=>1===e.length&&t.hasRegexChars(e),t.escapeRegex=t=>t.replace(a,"\\$1"),t.toPosixSlashes=t=>t.replace(n,"/"),t.removeBackslashes=t=>t.replace(r,(t=>"\\"===t?"":t)),t.supportsLookbehinds=()=>{const t=process.version.slice(1).split(".").map(Number);return 3===t.length&&t[0]>=9||8===t[0]&&t[1]>=10},t.isWindows=t=>t&&"boolean"==typeof t.windows?t.windows:!0===o||"\\"===e.sep,t.escapeLast=(e,o,n)=>{const r=e.lastIndexOf(o,n);return-1===r?e:"\\"===e[r-1]?t.escapeLast(e,o,r-1):`${e.slice(0,r)}\\${e.slice(r)}`},t.removePrefix=(t,e={})=>{let o=t;return o.startsWith("./")&&(o=o.slice(2),e.prefix="./"),o},t.wrapOutput=(t,e={},o={})=>{let n=`${o.contains?"":"^"}(?:${t})${o.contains?"":"$"}`;return!0===e.negated&&(n=`(?:^(?!${n}).*$)`),n}}(f);const x=f,{CHAR_ASTERISK:v,CHAR_AT:H,CHAR_BACKWARD_SLASH:m,CHAR_COMMA:T,CHAR_DOT:L,CHAR_EXCLAMATION_MARK:O,CHAR_FORWARD_SLASH:k,CHAR_LEFT_CURLY_BRACE:w,CHAR_LEFT_PARENTHESES:N,CHAR_LEFT_SQUARE_BRACKET:I,CHAR_PLUS:B,CHAR_QUESTION_MARK:M,CHAR_RIGHT_CURLY_BRACE:G,CHAR_RIGHT_PARENTHESES:P,CHAR_RIGHT_SQUARE_BRACKET:D}=C,U=t=>t===k||t===m,K=t=>{!0!==t.isPrefix&&(t.depth=t.isGlobstar?1/0:1)};var F=(t,e)=>{const o=e||{},n=t.length-1,r=!0===o.parts||!0===o.scanToEnd,s=[],a=[],u=[];let i,p,c=t,l=-1,f=0,A=0,R=!1,h=!1,g=!1,y=!1,_=!1,E=!1,b=!1,d=!1,S=!1,$=!1,C=0,F={value:"",depth:0,isGlob:!1};const X=()=>l>=n,Q=()=>(i=p,c.charCodeAt(++l));for(;l<n;){let t;if(p=Q(),p!==m){if(!0===E||p===w){for(C++;!0!==X()&&(p=Q());)if(p!==m)if(p!==w){if(!0!==E&&p===L&&(p=Q())===L){if(R=F.isBrace=!0,g=F.isGlob=!0,$=!0,!0===r)continue;break}if(!0!==E&&p===T){if(R=F.isBrace=!0,g=F.isGlob=!0,$=!0,!0===r)continue;break}if(p===G&&(C--,0===C)){E=!1,R=F.isBrace=!0,$=!0;break}}else C++;else b=F.backslashes=!0,Q();if(!0===r)continue;break}if(p!==k){if(!0!==o.noext){if(!0===(p===B||p===H||p===v||p===M||p===O)&&c.charCodeAt(l+1)===N){if(g=F.isGlob=!0,y=F.isExtglob=!0,$=!0,p===O&&l===f&&(S=!0),!0===r){for(;!0!==X()&&(p=Q());)if(p!==m){if(p===P){g=F.isGlob=!0,$=!0;break}}else b=F.backslashes=!0,p=Q();continue}break}}if(p===v){if(i===v&&(_=F.isGlobstar=!0),g=F.isGlob=!0,$=!0,!0===r)continue;break}if(p===M){if(g=F.isGlob=!0,$=!0,!0===r)continue;break}if(p===I){for(;!0!==X()&&(t=Q());)if(t!==m){if(t===D){h=F.isBracket=!0,g=F.isGlob=!0,$=!0;break}}else b=F.backslashes=!0,Q();if(!0===r)continue;break}if(!0===o.nonegate||p!==O||l!==f){if(!0!==o.noparen&&p===N){if(g=F.isGlob=!0,!0===r){for(;!0!==X()&&(p=Q());)if(p!==N){if(p===P){$=!0;break}}else b=F.backslashes=!0,p=Q();continue}break}if(!0===g){if($=!0,!0===r)continue;break}}else d=F.negated=!0,f++}else{if(s.push(l),a.push(F),F={value:"",depth:0,isGlob:!1},!0===$)continue;if(i===L&&l===f+1){f+=2;continue}A=l+1}}else b=F.backslashes=!0,p=Q(),p===w&&(E=!0)}!0===o.noext&&(y=!1,g=!1);let W=c,j="",q="";f>0&&(j=c.slice(0,f),c=c.slice(f),A-=f),W&&!0===g&&A>0?(W=c.slice(0,A),q=c.slice(A)):!0===g?(W="",q=c):W=c,W&&""!==W&&"/"!==W&&W!==c&&U(W.charCodeAt(W.length-1))&&(W=W.slice(0,-1)),!0===o.unescape&&(q&&(q=x.removeBackslashes(q)),W&&!0===b&&(W=x.removeBackslashes(W)));const Z={prefix:j,input:t,start:f,base:W,glob:q,isBrace:R,isBracket:h,isGlob:g,isExtglob:y,isGlobstar:_,negated:d,negatedExtglob:S};if(!0===o.tokens&&(Z.maxDepth=0,U(p)||a.push(F),Z.tokens=a),!0===o.parts||!0===o.tokens){let e;for(let n=0;n<s.length;n++){const r=e?e+1:f,i=s[n],p=t.slice(r,i);o.tokens&&(0===n&&0!==f?(a[n].isPrefix=!0,a[n].value=j):a[n].value=p,K(a[n]),Z.maxDepth+=a[n].depth),0===n&&""===p||u.push(p),e=i}if(e&&e+1<t.length){const n=t.slice(e+1);u.push(n),o.tokens&&(a[a.length-1].value=n,K(a[a.length-1]),Z.maxDepth+=a[a.length-1].depth)}Z.slashes=s,Z.parts=u}return Z};const X=C,Q=f,{MAX_LENGTH:W,POSIX_REGEX_SOURCE:j,REGEX_NON_SPECIAL_CHARS:q,REGEX_SPECIAL_CHARS_BACKREF:Z,REPLACEMENTS:z}=X,V=(t,e)=>{if("function"==typeof e.expandRange)return e.expandRange(...t,e);t.sort();const o=`[${t.join("-")}]`;try{new RegExp(o)}catch(e){return t.map((t=>Q.escapeRegex(t))).join("..")}return o},Y=(t,e)=>`Missing ${t}: "${e}" - use "\\\\${e}" to match literal characters`,J=(t,e)=>{if("string"!=typeof t)throw new TypeError("Expected a string");t=z[t]||t;const o={...e},n="number"==typeof o.maxLength?Math.min(W,o.maxLength):W;let r=t.length;if(r>n)throw new SyntaxError(`Input length: ${r}, exceeds maximum allowed length: ${n}`);const s={type:"bos",value:"",output:o.prepend||""},a=[s],u=o.capture?"":"?:",i=Q.isWindows(e),p=X.globChars(i),c=X.extglobChars(p),{DOT_LITERAL:l,PLUS_LITERAL:f,SLASH_LITERAL:A,ONE_CHAR:R,DOTS_SLASH:h,NO_DOT:g,NO_DOT_SLASH:y,NO_DOTS_SLASH:_,QMARK:E,QMARK_NO_DOT:b,STAR:d,START_ANCHOR:S}=p,$=t=>`(${u}(?:(?!${S}${t.dot?h:l}).)*?)`,C=o.dot?"":g,x=o.dot?E:b;let v=!0===o.bash?$(o):d;o.capture&&(v=`(${v})`),"boolean"==typeof o.noext&&(o.noextglob=o.noext);const H={input:t,index:-1,start:0,dot:!0===o.dot,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};t=Q.removePrefix(t,H),r=t.length;const m=[],T=[],L=[];let O,k=s;const w=()=>H.index===r-1,N=H.peek=(e=1)=>t[H.index+e],I=H.advance=()=>t[++H.index]||"",B=()=>t.slice(H.index+1),M=(t="",e=0)=>{H.consumed+=t,H.index+=e},G=t=>{H.output+=null!=t.output?t.output:t.value,M(t.value)},P=()=>{let t=1;for(;"!"===N()&&("("!==N(2)||"?"===N(3));)I(),H.start++,t++;return t%2!=0&&(H.negated=!0,H.start++,!0)},D=t=>{H[t]++,L.push(t)},U=t=>{H[t]--,L.pop()},K=t=>{if("globstar"===k.type){const e=H.braces>0&&("comma"===t.type||"brace"===t.type),o=!0===t.extglob||m.length&&("pipe"===t.type||"paren"===t.type);"slash"===t.type||"paren"===t.type||e||o||(H.output=H.output.slice(0,-k.output.length),k.type="star",k.value="*",k.output=v,H.output+=k.output)}if(m.length&&"paren"!==t.type&&(m[m.length-1].inner+=t.value),(t.value||t.output)&&G(t),k&&"text"===k.type&&"text"===t.type)return k.value+=t.value,void(k.output=(k.output||"")+t.value);t.prev=k,a.push(t),k=t},F=(t,e)=>{const n={...c[e],conditions:1,inner:""};n.prev=k,n.parens=H.parens,n.output=H.output;const r=(o.capture?"(":"")+n.open;D("parens"),K({type:t,value:e,output:H.output?"":R}),K({type:"paren",extglob:!0,value:I(),output:r}),m.push(n)},tt=t=>{let n,r=t.close+(o.capture?")":"");if("negate"===t.type){let s=v;if(t.inner&&t.inner.length>1&&t.inner.includes("/")&&(s=$(o)),(s!==v||w()||/^\)+$/.test(B()))&&(r=t.close=`)$))${s}`),t.inner.includes("*")&&(n=B())&&/^\.[^\\/.]+$/.test(n)){const o=J(n,{...e,fastpaths:!1}).output;r=t.close=`)${o})${s})`}"bos"===t.prev.type&&(H.negatedExtglob=!0)}K({type:"paren",extglob:!0,value:O,output:r}),U("parens")};if(!1!==o.fastpaths&&!/(^[*!]|[/()[\]{}"])/.test(t)){let n=!1,r=t.replace(Z,((t,e,o,r,s,a)=>"\\"===r?(n=!0,t):"?"===r?e?e+r+(s?E.repeat(s.length):""):0===a?x+(s?E.repeat(s.length):""):E.repeat(o.length):"."===r?l.repeat(o.length):"*"===r?e?e+r+(s?v:""):v:e?t:`\\${t}`));return!0===n&&(r=!0===o.unescape?r.replace(/\\/g,""):r.replace(/\\+/g,(t=>t.length%2==0?"\\\\":t?"\\":""))),r===t&&!0===o.contains?(H.output=t,H):(H.output=Q.wrapOutput(r,H,e),H)}for(;!w();){if(O=I(),"\0"===O)continue;if("\\"===O){const t=N();if("/"===t&&!0!==o.bash)continue;if("."===t||";"===t)continue;if(!t){O+="\\",K({type:"text",value:O});continue}const e=/^\\+/.exec(B());let n=0;if(e&&e[0].length>2&&(n=e[0].length,H.index+=n,n%2!=0&&(O+="\\")),!0===o.unescape?O=I():O+=I(),0===H.brackets){K({type:"text",value:O});continue}}if(H.brackets>0&&("]"!==O||"["===k.value||"[^"===k.value)){if(!1!==o.posix&&":"===O){const t=k.value.slice(1);if(t.includes("[")&&(k.posix=!0,t.includes(":"))){const t=k.value.lastIndexOf("["),e=k.value.slice(0,t),o=k.value.slice(t+2),n=j[o];if(n){k.value=e+n,H.backtrack=!0,I(),s.output||1!==a.indexOf(k)||(s.output=R);continue}}}("["===O&&":"!==N()||"-"===O&&"]"===N())&&(O=`\\${O}`),"]"!==O||"["!==k.value&&"[^"!==k.value||(O=`\\${O}`),!0===o.posix&&"!"===O&&"["===k.value&&(O="^"),k.value+=O,G({value:O});continue}if(1===H.quotes&&'"'!==O){O=Q.escapeRegex(O),k.value+=O,G({value:O});continue}if('"'===O){H.quotes=1===H.quotes?0:1,!0===o.keepQuotes&&K({type:"text",value:O});continue}if("("===O){D("parens"),K({type:"paren",value:O});continue}if(")"===O){if(0===H.parens&&!0===o.strictBrackets)throw new SyntaxError(Y("opening","("));const t=m[m.length-1];if(t&&H.parens===t.parens+1){tt(m.pop());continue}K({type:"paren",value:O,output:H.parens?")":"\\)"}),U("parens");continue}if("["===O){if(!0!==o.nobracket&&B().includes("]"))D("brackets");else{if(!0!==o.nobracket&&!0===o.strictBrackets)throw new SyntaxError(Y("closing","]"));O=`\\${O}`}K({type:"bracket",value:O});continue}if("]"===O){if(!0===o.nobracket||k&&"bracket"===k.type&&1===k.value.length){K({type:"text",value:O,output:`\\${O}`});continue}if(0===H.brackets){if(!0===o.strictBrackets)throw new SyntaxError(Y("opening","["));K({type:"text",value:O,output:`\\${O}`});continue}U("brackets");const t=k.value.slice(1);if(!0===k.posix||"^"!==t[0]||t.includes("/")||(O=`/${O}`),k.value+=O,G({value:O}),!1===o.literalBrackets||Q.hasRegexChars(t))continue;const e=Q.escapeRegex(k.value);if(H.output=H.output.slice(0,-k.value.length),!0===o.literalBrackets){H.output+=e,k.value=e;continue}k.value=`(${u}${e}|${k.value})`,H.output+=k.value;continue}if("{"===O&&!0!==o.nobrace){D("braces");const t={type:"brace",value:O,output:"(",outputIndex:H.output.length,tokensIndex:H.tokens.length};T.push(t),K(t);continue}if("}"===O){const t=T[T.length-1];if(!0===o.nobrace||!t){K({type:"text",value:O,output:O});continue}let e=")";if(!0===t.dots){const t=a.slice(),n=[];for(let e=t.length-1;e>=0&&(a.pop(),"brace"!==t[e].type);e--)"dots"!==t[e].type&&n.unshift(t[e].value);e=V(n,o),H.backtrack=!0}if(!0!==t.comma&&!0!==t.dots){const o=H.output.slice(0,t.outputIndex),n=H.tokens.slice(t.tokensIndex);t.value=t.output="\\{",O=e="\\}",H.output=o;for(const t of n)H.output+=t.output||t.value}K({type:"brace",value:O,output:e}),U("braces"),T.pop();continue}if("|"===O){m.length>0&&m[m.length-1].conditions++,K({type:"text",value:O});continue}if(","===O){let t=O;const e=T[T.length-1];e&&"braces"===L[L.length-1]&&(e.comma=!0,t="|"),K({type:"comma",value:O,output:t});continue}if("/"===O){if("dot"===k.type&&H.index===H.start+1){H.start=H.index+1,H.consumed="",H.output="",a.pop(),k=s;continue}K({type:"slash",value:O,output:A});continue}if("."===O){if(H.braces>0&&"dot"===k.type){"."===k.value&&(k.output=l);const t=T[T.length-1];k.type="dots",k.output+=O,k.value+=O,t.dots=!0;continue}if(H.braces+H.parens===0&&"bos"!==k.type&&"slash"!==k.type){K({type:"text",value:O,output:l});continue}K({type:"dot",value:O,output:l});continue}if("?"===O){if(!(k&&"("===k.value)&&!0!==o.noextglob&&"("===N()&&"?"!==N(2)){F("qmark",O);continue}if(k&&"paren"===k.type){const t=N();let e=O;if("<"===t&&!Q.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");("("===k.value&&!/[!=<:]/.test(t)||"<"===t&&!/<([!=]|\w+>)/.test(B()))&&(e=`\\${O}`),K({type:"text",value:O,output:e});continue}if(!0!==o.dot&&("slash"===k.type||"bos"===k.type)){K({type:"qmark",value:O,output:b});continue}K({type:"qmark",value:O,output:E});continue}if("!"===O){if(!0!==o.noextglob&&"("===N()&&("?"!==N(2)||!/[!=<:]/.test(N(3)))){F("negate",O);continue}if(!0!==o.nonegate&&0===H.index){P();continue}}if("+"===O){if(!0!==o.noextglob&&"("===N()&&"?"!==N(2)){F("plus",O);continue}if(k&&"("===k.value||!1===o.regex){K({type:"plus",value:O,output:f});continue}if(k&&("bracket"===k.type||"paren"===k.type||"brace"===k.type)||H.parens>0){K({type:"plus",value:O});continue}K({type:"plus",value:f});continue}if("@"===O){if(!0!==o.noextglob&&"("===N()&&"?"!==N(2)){K({type:"at",extglob:!0,value:O,output:""});continue}K({type:"text",value:O});continue}if("*"!==O){"$"!==O&&"^"!==O||(O=`\\${O}`);const t=q.exec(B());t&&(O+=t[0],H.index+=t[0].length),K({type:"text",value:O});continue}if(k&&("globstar"===k.type||!0===k.star)){k.type="star",k.star=!0,k.value+=O,k.output=v,H.backtrack=!0,H.globstar=!0,M(O);continue}let e=B();if(!0!==o.noextglob&&/^\([^?]/.test(e)){F("star",O);continue}if("star"===k.type){if(!0===o.noglobstar){M(O);continue}const n=k.prev,r=n.prev,s="slash"===n.type||"bos"===n.type,a=r&&("star"===r.type||"globstar"===r.type);if(!0===o.bash&&(!s||e[0]&&"/"!==e[0])){K({type:"star",value:O,output:""});continue}const u=H.braces>0&&("comma"===n.type||"brace"===n.type),i=m.length&&("pipe"===n.type||"paren"===n.type);if(!s&&"paren"!==n.type&&!u&&!i){K({type:"star",value:O,output:""});continue}for(;"/**"===e.slice(0,3);){const o=t[H.index+4];if(o&&"/"!==o)break;e=e.slice(3),M("/**",3)}if("bos"===n.type&&w()){k.type="globstar",k.value+=O,k.output=$(o),H.output=k.output,H.globstar=!0,M(O);continue}if("slash"===n.type&&"bos"!==n.prev.type&&!a&&w()){H.output=H.output.slice(0,-(n.output+k.output).length),n.output=`(?:${n.output}`,k.type="globstar",k.output=$(o)+(o.strictSlashes?")":"|$)"),k.value+=O,H.globstar=!0,H.output+=n.output+k.output,M(O);continue}if("slash"===n.type&&"bos"!==n.prev.type&&"/"===e[0]){const t=void 0!==e[1]?"|$":"";H.output=H.output.slice(0,-(n.output+k.output).length),n.output=`(?:${n.output}`,k.type="globstar",k.output=`${$(o)}${A}|${A}${t})`,k.value+=O,H.output+=n.output+k.output,H.globstar=!0,M(O+I()),K({type:"slash",value:"/",output:""});continue}if("bos"===n.type&&"/"===e[0]){k.type="globstar",k.value+=O,k.output=`(?:^|${A}|${$(o)}${A})`,H.output=k.output,H.globstar=!0,M(O+I()),K({type:"slash",value:"/",output:""});continue}H.output=H.output.slice(0,-k.output.length),k.type="globstar",k.output=$(o),k.value+=O,H.output+=k.output,H.globstar=!0,M(O);continue}const n={type:"star",value:O,output:v};!0!==o.bash?!k||"bracket"!==k.type&&"paren"!==k.type||!0!==o.regex?(H.index!==H.start&&"slash"!==k.type&&"dot"!==k.type||("dot"===k.type?(H.output+=y,k.output+=y):!0===o.dot?(H.output+=_,k.output+=_):(H.output+=C,k.output+=C),"*"!==N()&&(H.output+=R,k.output+=R)),K(n)):(n.output=O,K(n)):(n.output=".*?","bos"!==k.type&&"slash"!==k.type||(n.output=C+n.output),K(n))}for(;H.brackets>0;){if(!0===o.strictBrackets)throw new SyntaxError(Y("closing","]"));H.output=Q.escapeLast(H.output,"["),U("brackets")}for(;H.parens>0;){if(!0===o.strictBrackets)throw new SyntaxError(Y("closing",")"));H.output=Q.escapeLast(H.output,"("),U("parens")}for(;H.braces>0;){if(!0===o.strictBrackets)throw new SyntaxError(Y("closing","}"));H.output=Q.escapeLast(H.output,"{"),U("braces")}if(!0===o.strictSlashes||"star"!==k.type&&"bracket"!==k.type||K({type:"maybe_slash",value:"",output:`${A}?`}),!0===H.backtrack){H.output="";for(const t of H.tokens)H.output+=null!=t.output?t.output:t.value,t.suffix&&(H.output+=t.suffix)}return H};J.fastpaths=(t,e)=>{const o={...e},n="number"==typeof o.maxLength?Math.min(W,o.maxLength):W,r=t.length;if(r>n)throw new SyntaxError(`Input length: ${r}, exceeds maximum allowed length: ${n}`);t=z[t]||t;const s=Q.isWindows(e),{DOT_LITERAL:a,SLASH_LITERAL:u,ONE_CHAR:i,DOTS_SLASH:p,NO_DOT:c,NO_DOTS:l,NO_DOTS_SLASH:f,STAR:A,START_ANCHOR:R}=X.globChars(s),h=o.dot?l:c,g=o.dot?f:c,y=o.capture?"":"?:";let _=!0===o.bash?".*?":A;o.capture&&(_=`(${_})`);const E=t=>!0===t.noglobstar?_:`(${y}(?:(?!${R}${t.dot?p:a}).)*?)`,b=t=>{switch(t){case"*":return`${h}${i}${_}`;case".*":return`${a}${i}${_}`;case"*.*":return`${h}${_}${a}${i}${_}`;case"*/*":return`${h}${_}${u}${i}${g}${_}`;case"**":return h+E(o);case"**/*":return`(?:${h}${E(o)}${u})?${g}${i}${_}`;case"**/*.*":return`(?:${h}${E(o)}${u})?${g}${_}${a}${i}${_}`;case"**/.*":return`(?:${h}${E(o)}${u})?${a}${i}${_}`;default:{const e=/^(.*?)\.(\w+)$/.exec(t);if(!e)return;const o=b(e[1]);if(!o)return;return o+a+e[2]}}},d=Q.removePrefix(t,{negated:!1,prefix:""});let S=b(d);return S&&!0!==o.strictSlashes&&(S+=`${u}?`),S};const tt=i,et=F,ot=J,nt=f,rt=C,st=(t,e,o=!1)=>{if(Array.isArray(t)){const n=t.map((t=>st(t,e,o))),r=t=>{for(const e of n){const o=e(t);if(o)return o}return!1};return r}const n=(r=t)&&"object"==typeof r&&!Array.isArray(r)&&t.tokens&&t.input;var r;if(""===t||"string"!=typeof t&&!n)throw new TypeError("Expected pattern to be a non-empty string");const s=e||{},a=nt.isWindows(e),u=n?st.compileRe(t,e):st.makeRe(t,e,!1,!0),i=u.state;delete u.state;let p=()=>!1;if(s.ignore){const t={...e,ignore:null,onMatch:null,onResult:null};p=st(s.ignore,t,o)}const c=(o,n=!1)=>{const{isMatch:r,match:c,output:l}=st.test(o,u,e,{glob:t,posix:a}),f={glob:t,state:i,regex:u,posix:a,input:o,output:l,match:c,isMatch:r};return"function"==typeof s.onResult&&s.onResult(f),!1===r?(f.isMatch=!1,!!n&&f):p(o)?("function"==typeof s.onIgnore&&s.onIgnore(f),f.isMatch=!1,!!n&&f):("function"==typeof s.onMatch&&s.onMatch(f),!n||f)};return o&&(c.state=i),c};st.test=(t,e,o,{glob:n,posix:r}={})=>{if("string"!=typeof t)throw new TypeError("Expected input to be a string");if(""===t)return{isMatch:!1,output:""};const s=o||{},a=s.format||(r?nt.toPosixSlashes:null);let u=t===n,i=u&&a?a(t):t;return!1===u&&(i=a?a(t):t,u=i===n),!1!==u&&!0!==s.capture||(u=!0===s.matchBase||!0===s.basename?st.matchBase(t,e,o,r):e.exec(i)),{isMatch:Boolean(u),match:u,output:i}},st.matchBase=(t,e,o,n=nt.isWindows(o))=>(e instanceof RegExp?e:st.makeRe(e,o)).test(tt.basename(t)),st.isMatch=(t,e,o)=>st(e,o)(t),st.parse=(t,e)=>Array.isArray(t)?t.map((t=>st.parse(t,e))):ot(t,{...e,fastpaths:!1}),st.scan=(t,e)=>et(t,e),st.compileRe=(t,e,o=!1,n=!1)=>{if(!0===o)return t.output;const r=e||{},s=r.contains?"":"^",a=r.contains?"":"$";let u=`${s}(?:${t.output})${a}`;t&&!0===t.negated&&(u=`^(?!${u}).*$`);const i=st.toRegex(u,e);return!0===n&&(i.state=t),i},st.makeRe=(t,e={},o=!1,n=!1)=>{if(!t||"string"!=typeof t)throw new TypeError("Expected a non-empty string");let r={negated:!1,fastpaths:!0};return!1===e.fastpaths||"."!==t[0]&&"*"!==t[0]||(r.output=ot.fastpaths(t,e)),r.output||(r=ot(t,e)),st.compileRe(r,e,o,n)},st.toRegex=(t,e)=>{try{const o=e||{};return new RegExp(t,o.flags||(o.nocase?"i":""))}catch(t){if(e&&!0===e.debug)throw t;return/$^/}},st.constants=rt;var at=p(st);function ut(t){return e=t,Array.isArray(e)?t:null==t?[]:[t];var e}const it=function(t){return t.split(i.win32.sep).join(i.posix.sep)};new Set("break case class catch const continue debugger default delete do else export extends finally for function if import in instanceof let new return super switch this throw try typeof var void while with yield enum await implements package protected static interface private public arguments Infinity NaN undefined null true false eval uneval isFinite isNaN parseFloat parseInt decodeURI decodeURIComponent encodeURI encodeURIComponent escape unescape Object Function Boolean Symbol Error EvalError InternalError RangeError ReferenceError SyntaxError TypeError URIError Number Math Date String RegExp Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array Map Set WeakMap WeakSet SIMD ArrayBuffer DataView JSON Promise Generator GeneratorFunction Reflect Proxy Intl".split(" ")).add(""),console.log("version 0.0.1");const pt=function(t,e,o){const n=o&&o.resolve,r=t=>t instanceof RegExp?t:{test:e=>{const o=function(t,e){if(!1===e||i.isAbsolute(t)||t.startsWith("**"))return it(t);const o=it(i.resolve(e||"")).replace(/[-^$*+?.()|[\]{}]/g,"\\$&");return i.posix.join(o,it(t))}(t,n);return at(o,{dot:!0})(e)}},s=ut(t).map(r),a=ut(e).map(r);return function(t){if("string"!=typeof t)return!1;if(/\0/.test(t))return!1;const e=it(t);for(let t=0;t<a.length;++t){if(a[t].test(e))return!1}for(let t=0;t<s.length;++t){if(s[t].test(e))return!0}return!s.length}}(/\.(png|svg|jpg)$/,void 0,{resolve:!1}),ct=a.clone().use(l).use(u);function lt(t){const e="<svg";return t.toString("utf8",0,4)===e}function ft(t){const e=(new n.PassThrough).end(t);return new Promise((t=>{ct(e,"when piped through",new r([128,"--quality","60-80","--nofs"]),"to yield output satisfying",ct.it((e=>{t(e)})))}))}return function(n){return{name:"rollup-plugin-imgmin",async generateBundle(n,r){for(const n in r)if(pt(n)){let a=r[n].source;if(!Buffer.isBuffer(a))return;if(lt(a)){Buffer.isBuffer(a)&&(a=a.toString());try{const{data:t}=s.optimize(a);a=Buffer.from(t)}catch(t){console.log(`err--${n}`,t)}}if(t(a)){const t={};a=o(a).encode("jpg",{quality:70,...t})}e(a)&&(console.log("old",a.length),a=await ft(a),console.log("new",a.length)),r[n]={...r[n],source:a}}}}}}(isJpg,isPng,images,stream,PngQuant,svgo,unexpected,unexpectedSinon,require$$0$1);
