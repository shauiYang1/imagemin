var version=function(t,e,n,o,r,a,s,u,i){"use strict";function p(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var c={name:"unexpected-stream",version:"5.1.0",installInto(t){t.addType({name:"Stream",base:"object",inspect(t,e,n,o){n.text(t.constructor&&t.constructor.name||"Stream","jsFunctionName")},identify:t=>t&&"function"==typeof t.on&&(t._readableState||"boolean"==typeof t.readable||"boolean"==typeof t.writable)}),t.addAssertion("<Stream|string|Buffer|array> [when] piped through <array|Stream> <assertion?>",((t,e,n)=>(t.errorMode="nested",t.promise(((o,r)=>{const a=Array.isArray(n)?n:[n];t(a,"not to be empty");const s=t.findTypeOf(e);let u;s.is("Stream")&&(u=e,e.on("error",r));const i=t.shift(a[a.length-1]);if(a.forEach((t=>{t.on("error",r),u=u?u.pipe(t):t})),!s.is("Stream"))try{(Array.isArray(e)?e:[e]).forEach((t=>{a[0].write(t)})),a[0].end()}catch(t){return r(t)}return o(i)})))));const e=new WeakMap;function n(n){let o=e.get(n);return o||(o=t.promise(((e,o)=>{t(n,"to have property","readable",!0);const r=[];n.on("data",(t=>{r.push(t)})).on("end",(()=>{e(r)})).on("error",o)})),e.set(n,o)),o}t.addAssertion(["<Stream> to yield (output|chunks|objects) satisfying <any+>","<Stream> to yield (output|chunks|objects) satisfying <assertion>"],(function(t,e,o){t.errorMode="nested";const r=Array.prototype.slice.call(arguments,2),a="output"===t.alternations[0];return t.promise(((t,o)=>{n(e).then((e=>{let n;n=a?e.length>0&&e.every((t=>"string"==typeof t))?e.join(""):Buffer.concat(e.map((t=>"string"==typeof t?Buffer.from?Buffer.from(t,"utf-8"):new Buffer(t,"utf-8"):t))):e,t(n)}),o)})).then((e=>t.apply(t,[e,"to satisfy assertion"].concat(r))))})),t.addAssertion("<Stream> to error",((t,e)=>n(e).then((()=>{t.fail(new Error("Stream was supposed to fail, but ended correctly"))}),(t=>t)))),t.addAssertion("<Stream> to error with <any>",((t,e,n)=>(t.errorMode="nested",t(e,"to error").then((e=>t(e,"to satisfy",n))))))}},l=p(c),f={};const A=i,R="\\\\/",y=`[^${R}]`,g="\\.",h="\\/",_="[^/]",E=`(?:${h}|$)`,d=`(?:^|${h})`,b=`${g}{1,2}${E}`,S={DOT_LITERAL:g,PLUS_LITERAL:"\\+",QMARK_LITERAL:"\\?",SLASH_LITERAL:h,ONE_CHAR:"(?=.)",QMARK:_,END_ANCHOR:E,DOTS_SLASH:b,NO_DOT:`(?!${g})`,NO_DOTS:`(?!${d}${b})`,NO_DOT_SLASH:`(?!${g}{0,1}${E})`,NO_DOTS_SLASH:`(?!${b})`,QMARK_NO_DOT:`[^.${h}]`,STAR:`${_}*?`,START_ANCHOR:d},$={...S,SLASH_LITERAL:`[${R}]`,QMARK:y,STAR:`${y}*?`,DOTS_SLASH:`${g}{1,2}(?:[${R}]|$)`,NO_DOT:`(?!${g})`,NO_DOTS:`(?!(?:^|[${R}])${g}{1,2}(?:[${R}]|$))`,NO_DOT_SLASH:`(?!${g}{0,1}(?:[${R}]|$))`,NO_DOTS_SLASH:`(?!${g}{1,2}(?:[${R}]|$))`,QMARK_NO_DOT:`[^.${R}]`,START_ANCHOR:`(?:^|[${R}])`,END_ANCHOR:`(?:[${R}]|$)`};var C={MAX_LENGTH:65536,POSIX_REGEX_SOURCE:{alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"},REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:A.sep,extglobChars:t=>({"!":{type:"negate",open:"(?:(?!(?:",close:`))${t.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}),globChars:t=>!0===t?$:S};!function(t){const e=i,n="win32"===process.platform,{REGEX_BACKSLASH:o,REGEX_REMOVE_BACKSLASH:r,REGEX_SPECIAL_CHARS:a,REGEX_SPECIAL_CHARS_GLOBAL:s}=C;t.isObject=t=>null!==t&&"object"==typeof t&&!Array.isArray(t),t.hasRegexChars=t=>a.test(t),t.isRegexChar=e=>1===e.length&&t.hasRegexChars(e),t.escapeRegex=t=>t.replace(s,"\\$1"),t.toPosixSlashes=t=>t.replace(o,"/"),t.removeBackslashes=t=>t.replace(r,(t=>"\\"===t?"":t)),t.supportsLookbehinds=()=>{const t=process.version.slice(1).split(".").map(Number);return 3===t.length&&t[0]>=9||8===t[0]&&t[1]>=10},t.isWindows=t=>t&&"boolean"==typeof t.windows?t.windows:!0===n||"\\"===e.sep,t.escapeLast=(e,n,o)=>{const r=e.lastIndexOf(n,o);return-1===r?e:"\\"===e[r-1]?t.escapeLast(e,n,r-1):`${e.slice(0,r)}\\${e.slice(r)}`},t.removePrefix=(t,e={})=>{let n=t;return n.startsWith("./")&&(n=n.slice(2),e.prefix="./"),n},t.wrapOutput=(t,e={},n={})=>{let o=`${n.contains?"":"^"}(?:${t})${n.contains?"":"$"}`;return!0===e.negated&&(o=`(?:^(?!${o}).*$)`),o}}(f);const x=f,{CHAR_ASTERISK:v,CHAR_AT:H,CHAR_BACKWARD_SLASH:m,CHAR_COMMA:T,CHAR_DOT:L,CHAR_EXCLAMATION_MARK:O,CHAR_FORWARD_SLASH:k,CHAR_LEFT_CURLY_BRACE:w,CHAR_LEFT_PARENTHESES:N,CHAR_LEFT_SQUARE_BRACKET:I,CHAR_PLUS:B,CHAR_QUESTION_MARK:M,CHAR_RIGHT_CURLY_BRACE:G,CHAR_RIGHT_PARENTHESES:P,CHAR_RIGHT_SQUARE_BRACKET:D}=C,U=t=>t===k||t===m,K=t=>{!0!==t.isPrefix&&(t.depth=t.isGlobstar?1/0:1)};var F=(t,e)=>{const n=e||{},o=t.length-1,r=!0===n.parts||!0===n.scanToEnd,a=[],s=[],u=[];let i,p,c=t,l=-1,f=0,A=0,R=!1,y=!1,g=!1,h=!1,_=!1,E=!1,d=!1,b=!1,S=!1,$=!1,C=0,F={value:"",depth:0,isGlob:!1};const Q=()=>l>=o,j=()=>(i=p,c.charCodeAt(++l));for(;l<o;){let t;if(p=j(),p!==m){if(!0===E||p===w){for(C++;!0!==Q()&&(p=j());)if(p!==m)if(p!==w){if(!0!==E&&p===L&&(p=j())===L){if(R=F.isBrace=!0,g=F.isGlob=!0,$=!0,!0===r)continue;break}if(!0!==E&&p===T){if(R=F.isBrace=!0,g=F.isGlob=!0,$=!0,!0===r)continue;break}if(p===G&&(C--,0===C)){E=!1,R=F.isBrace=!0,$=!0;break}}else C++;else d=F.backslashes=!0,j();if(!0===r)continue;break}if(p!==k){if(!0!==n.noext){if(!0===(p===B||p===H||p===v||p===M||p===O)&&c.charCodeAt(l+1)===N){if(g=F.isGlob=!0,h=F.isExtglob=!0,$=!0,p===O&&l===f&&(S=!0),!0===r){for(;!0!==Q()&&(p=j());)if(p!==m){if(p===P){g=F.isGlob=!0,$=!0;break}}else d=F.backslashes=!0,p=j();continue}break}}if(p===v){if(i===v&&(_=F.isGlobstar=!0),g=F.isGlob=!0,$=!0,!0===r)continue;break}if(p===M){if(g=F.isGlob=!0,$=!0,!0===r)continue;break}if(p===I){for(;!0!==Q()&&(t=j());)if(t!==m){if(t===D){y=F.isBracket=!0,g=F.isGlob=!0,$=!0;break}}else d=F.backslashes=!0,j();if(!0===r)continue;break}if(!0===n.nonegate||p!==O||l!==f){if(!0!==n.noparen&&p===N){if(g=F.isGlob=!0,!0===r){for(;!0!==Q()&&(p=j());)if(p!==N){if(p===P){$=!0;break}}else d=F.backslashes=!0,p=j();continue}break}if(!0===g){if($=!0,!0===r)continue;break}}else b=F.negated=!0,f++}else{if(a.push(l),s.push(F),F={value:"",depth:0,isGlob:!1},!0===$)continue;if(i===L&&l===f+1){f+=2;continue}A=l+1}}else d=F.backslashes=!0,p=j(),p===w&&(E=!0)}!0===n.noext&&(h=!1,g=!1);let X=c,W="",q="";f>0&&(W=c.slice(0,f),c=c.slice(f),A-=f),X&&!0===g&&A>0?(X=c.slice(0,A),q=c.slice(A)):!0===g?(X="",q=c):X=c,X&&""!==X&&"/"!==X&&X!==c&&U(X.charCodeAt(X.length-1))&&(X=X.slice(0,-1)),!0===n.unescape&&(q&&(q=x.removeBackslashes(q)),X&&!0===d&&(X=x.removeBackslashes(X)));const Z={prefix:W,input:t,start:f,base:X,glob:q,isBrace:R,isBracket:y,isGlob:g,isExtglob:h,isGlobstar:_,negated:b,negatedExtglob:S};if(!0===n.tokens&&(Z.maxDepth=0,U(p)||s.push(F),Z.tokens=s),!0===n.parts||!0===n.tokens){let e;for(let o=0;o<a.length;o++){const r=e?e+1:f,i=a[o],p=t.slice(r,i);n.tokens&&(0===o&&0!==f?(s[o].isPrefix=!0,s[o].value=W):s[o].value=p,K(s[o]),Z.maxDepth+=s[o].depth),0===o&&""===p||u.push(p),e=i}if(e&&e+1<t.length){const o=t.slice(e+1);u.push(o),n.tokens&&(s[s.length-1].value=o,K(s[s.length-1]),Z.maxDepth+=s[s.length-1].depth)}Z.slashes=a,Z.parts=u}return Z};const Q=C,j=f,{MAX_LENGTH:X,POSIX_REGEX_SOURCE:W,REGEX_NON_SPECIAL_CHARS:q,REGEX_SPECIAL_CHARS_BACKREF:Z,REPLACEMENTS:z}=Q,V=(t,e)=>{if("function"==typeof e.expandRange)return e.expandRange(...t,e);t.sort();const n=`[${t.join("-")}]`;try{new RegExp(n)}catch(e){return t.map((t=>j.escapeRegex(t))).join("..")}return n},Y=(t,e)=>`Missing ${t}: "${e}" - use "\\\\${e}" to match literal characters`,J=(t,e)=>{if("string"!=typeof t)throw new TypeError("Expected a string");t=z[t]||t;const n={...e},o="number"==typeof n.maxLength?Math.min(X,n.maxLength):X;let r=t.length;if(r>o)throw new SyntaxError(`Input length: ${r}, exceeds maximum allowed length: ${o}`);const a={type:"bos",value:"",output:n.prepend||""},s=[a],u=n.capture?"":"?:",i=j.isWindows(e),p=Q.globChars(i),c=Q.extglobChars(p),{DOT_LITERAL:l,PLUS_LITERAL:f,SLASH_LITERAL:A,ONE_CHAR:R,DOTS_SLASH:y,NO_DOT:g,NO_DOT_SLASH:h,NO_DOTS_SLASH:_,QMARK:E,QMARK_NO_DOT:d,STAR:b,START_ANCHOR:S}=p,$=t=>`(${u}(?:(?!${S}${t.dot?y:l}).)*?)`,C=n.dot?"":g,x=n.dot?E:d;let v=!0===n.bash?$(n):b;n.capture&&(v=`(${v})`),"boolean"==typeof n.noext&&(n.noextglob=n.noext);const H={input:t,index:-1,start:0,dot:!0===n.dot,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:s};t=j.removePrefix(t,H),r=t.length;const m=[],T=[],L=[];let O,k=a;const w=()=>H.index===r-1,N=H.peek=(e=1)=>t[H.index+e],I=H.advance=()=>t[++H.index]||"",B=()=>t.slice(H.index+1),M=(t="",e=0)=>{H.consumed+=t,H.index+=e},G=t=>{H.output+=null!=t.output?t.output:t.value,M(t.value)},P=()=>{let t=1;for(;"!"===N()&&("("!==N(2)||"?"===N(3));)I(),H.start++,t++;return t%2!=0&&(H.negated=!0,H.start++,!0)},D=t=>{H[t]++,L.push(t)},U=t=>{H[t]--,L.pop()},K=t=>{if("globstar"===k.type){const e=H.braces>0&&("comma"===t.type||"brace"===t.type),n=!0===t.extglob||m.length&&("pipe"===t.type||"paren"===t.type);"slash"===t.type||"paren"===t.type||e||n||(H.output=H.output.slice(0,-k.output.length),k.type="star",k.value="*",k.output=v,H.output+=k.output)}if(m.length&&"paren"!==t.type&&(m[m.length-1].inner+=t.value),(t.value||t.output)&&G(t),k&&"text"===k.type&&"text"===t.type)return k.value+=t.value,void(k.output=(k.output||"")+t.value);t.prev=k,s.push(t),k=t},F=(t,e)=>{const o={...c[e],conditions:1,inner:""};o.prev=k,o.parens=H.parens,o.output=H.output;const r=(n.capture?"(":"")+o.open;D("parens"),K({type:t,value:e,output:H.output?"":R}),K({type:"paren",extglob:!0,value:I(),output:r}),m.push(o)},tt=t=>{let o,r=t.close+(n.capture?")":"");if("negate"===t.type){let a=v;if(t.inner&&t.inner.length>1&&t.inner.includes("/")&&(a=$(n)),(a!==v||w()||/^\)+$/.test(B()))&&(r=t.close=`)$))${a}`),t.inner.includes("*")&&(o=B())&&/^\.[^\\/.]+$/.test(o)){const n=J(o,{...e,fastpaths:!1}).output;r=t.close=`)${n})${a})`}"bos"===t.prev.type&&(H.negatedExtglob=!0)}K({type:"paren",extglob:!0,value:O,output:r}),U("parens")};if(!1!==n.fastpaths&&!/(^[*!]|[/()[\]{}"])/.test(t)){let o=!1,r=t.replace(Z,((t,e,n,r,a,s)=>"\\"===r?(o=!0,t):"?"===r?e?e+r+(a?E.repeat(a.length):""):0===s?x+(a?E.repeat(a.length):""):E.repeat(n.length):"."===r?l.repeat(n.length):"*"===r?e?e+r+(a?v:""):v:e?t:`\\${t}`));return!0===o&&(r=!0===n.unescape?r.replace(/\\/g,""):r.replace(/\\+/g,(t=>t.length%2==0?"\\\\":t?"\\":""))),r===t&&!0===n.contains?(H.output=t,H):(H.output=j.wrapOutput(r,H,e),H)}for(;!w();){if(O=I(),"\0"===O)continue;if("\\"===O){const t=N();if("/"===t&&!0!==n.bash)continue;if("."===t||";"===t)continue;if(!t){O+="\\",K({type:"text",value:O});continue}const e=/^\\+/.exec(B());let o=0;if(e&&e[0].length>2&&(o=e[0].length,H.index+=o,o%2!=0&&(O+="\\")),!0===n.unescape?O=I():O+=I(),0===H.brackets){K({type:"text",value:O});continue}}if(H.brackets>0&&("]"!==O||"["===k.value||"[^"===k.value)){if(!1!==n.posix&&":"===O){const t=k.value.slice(1);if(t.includes("[")&&(k.posix=!0,t.includes(":"))){const t=k.value.lastIndexOf("["),e=k.value.slice(0,t),n=k.value.slice(t+2),o=W[n];if(o){k.value=e+o,H.backtrack=!0,I(),a.output||1!==s.indexOf(k)||(a.output=R);continue}}}("["===O&&":"!==N()||"-"===O&&"]"===N())&&(O=`\\${O}`),"]"!==O||"["!==k.value&&"[^"!==k.value||(O=`\\${O}`),!0===n.posix&&"!"===O&&"["===k.value&&(O="^"),k.value+=O,G({value:O});continue}if(1===H.quotes&&'"'!==O){O=j.escapeRegex(O),k.value+=O,G({value:O});continue}if('"'===O){H.quotes=1===H.quotes?0:1,!0===n.keepQuotes&&K({type:"text",value:O});continue}if("("===O){D("parens"),K({type:"paren",value:O});continue}if(")"===O){if(0===H.parens&&!0===n.strictBrackets)throw new SyntaxError(Y("opening","("));const t=m[m.length-1];if(t&&H.parens===t.parens+1){tt(m.pop());continue}K({type:"paren",value:O,output:H.parens?")":"\\)"}),U("parens");continue}if("["===O){if(!0!==n.nobracket&&B().includes("]"))D("brackets");else{if(!0!==n.nobracket&&!0===n.strictBrackets)throw new SyntaxError(Y("closing","]"));O=`\\${O}`}K({type:"bracket",value:O});continue}if("]"===O){if(!0===n.nobracket||k&&"bracket"===k.type&&1===k.value.length){K({type:"text",value:O,output:`\\${O}`});continue}if(0===H.brackets){if(!0===n.strictBrackets)throw new SyntaxError(Y("opening","["));K({type:"text",value:O,output:`\\${O}`});continue}U("brackets");const t=k.value.slice(1);if(!0===k.posix||"^"!==t[0]||t.includes("/")||(O=`/${O}`),k.value+=O,G({value:O}),!1===n.literalBrackets||j.hasRegexChars(t))continue;const e=j.escapeRegex(k.value);if(H.output=H.output.slice(0,-k.value.length),!0===n.literalBrackets){H.output+=e,k.value=e;continue}k.value=`(${u}${e}|${k.value})`,H.output+=k.value;continue}if("{"===O&&!0!==n.nobrace){D("braces");const t={type:"brace",value:O,output:"(",outputIndex:H.output.length,tokensIndex:H.tokens.length};T.push(t),K(t);continue}if("}"===O){const t=T[T.length-1];if(!0===n.nobrace||!t){K({type:"text",value:O,output:O});continue}let e=")";if(!0===t.dots){const t=s.slice(),o=[];for(let e=t.length-1;e>=0&&(s.pop(),"brace"!==t[e].type);e--)"dots"!==t[e].type&&o.unshift(t[e].value);e=V(o,n),H.backtrack=!0}if(!0!==t.comma&&!0!==t.dots){const n=H.output.slice(0,t.outputIndex),o=H.tokens.slice(t.tokensIndex);t.value=t.output="\\{",O=e="\\}",H.output=n;for(const t of o)H.output+=t.output||t.value}K({type:"brace",value:O,output:e}),U("braces"),T.pop();continue}if("|"===O){m.length>0&&m[m.length-1].conditions++,K({type:"text",value:O});continue}if(","===O){let t=O;const e=T[T.length-1];e&&"braces"===L[L.length-1]&&(e.comma=!0,t="|"),K({type:"comma",value:O,output:t});continue}if("/"===O){if("dot"===k.type&&H.index===H.start+1){H.start=H.index+1,H.consumed="",H.output="",s.pop(),k=a;continue}K({type:"slash",value:O,output:A});continue}if("."===O){if(H.braces>0&&"dot"===k.type){"."===k.value&&(k.output=l);const t=T[T.length-1];k.type="dots",k.output+=O,k.value+=O,t.dots=!0;continue}if(H.braces+H.parens===0&&"bos"!==k.type&&"slash"!==k.type){K({type:"text",value:O,output:l});continue}K({type:"dot",value:O,output:l});continue}if("?"===O){if(!(k&&"("===k.value)&&!0!==n.noextglob&&"("===N()&&"?"!==N(2)){F("qmark",O);continue}if(k&&"paren"===k.type){const t=N();let e=O;if("<"===t&&!j.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");("("===k.value&&!/[!=<:]/.test(t)||"<"===t&&!/<([!=]|\w+>)/.test(B()))&&(e=`\\${O}`),K({type:"text",value:O,output:e});continue}if(!0!==n.dot&&("slash"===k.type||"bos"===k.type)){K({type:"qmark",value:O,output:d});continue}K({type:"qmark",value:O,output:E});continue}if("!"===O){if(!0!==n.noextglob&&"("===N()&&("?"!==N(2)||!/[!=<:]/.test(N(3)))){F("negate",O);continue}if(!0!==n.nonegate&&0===H.index){P();continue}}if("+"===O){if(!0!==n.noextglob&&"("===N()&&"?"!==N(2)){F("plus",O);continue}if(k&&"("===k.value||!1===n.regex){K({type:"plus",value:O,output:f});continue}if(k&&("bracket"===k.type||"paren"===k.type||"brace"===k.type)||H.parens>0){K({type:"plus",value:O});continue}K({type:"plus",value:f});continue}if("@"===O){if(!0!==n.noextglob&&"("===N()&&"?"!==N(2)){K({type:"at",extglob:!0,value:O,output:""});continue}K({type:"text",value:O});continue}if("*"!==O){"$"!==O&&"^"!==O||(O=`\\${O}`);const t=q.exec(B());t&&(O+=t[0],H.index+=t[0].length),K({type:"text",value:O});continue}if(k&&("globstar"===k.type||!0===k.star)){k.type="star",k.star=!0,k.value+=O,k.output=v,H.backtrack=!0,H.globstar=!0,M(O);continue}let e=B();if(!0!==n.noextglob&&/^\([^?]/.test(e)){F("star",O);continue}if("star"===k.type){if(!0===n.noglobstar){M(O);continue}const o=k.prev,r=o.prev,a="slash"===o.type||"bos"===o.type,s=r&&("star"===r.type||"globstar"===r.type);if(!0===n.bash&&(!a||e[0]&&"/"!==e[0])){K({type:"star",value:O,output:""});continue}const u=H.braces>0&&("comma"===o.type||"brace"===o.type),i=m.length&&("pipe"===o.type||"paren"===o.type);if(!a&&"paren"!==o.type&&!u&&!i){K({type:"star",value:O,output:""});continue}for(;"/**"===e.slice(0,3);){const n=t[H.index+4];if(n&&"/"!==n)break;e=e.slice(3),M("/**",3)}if("bos"===o.type&&w()){k.type="globstar",k.value+=O,k.output=$(n),H.output=k.output,H.globstar=!0,M(O);continue}if("slash"===o.type&&"bos"!==o.prev.type&&!s&&w()){H.output=H.output.slice(0,-(o.output+k.output).length),o.output=`(?:${o.output}`,k.type="globstar",k.output=$(n)+(n.strictSlashes?")":"|$)"),k.value+=O,H.globstar=!0,H.output+=o.output+k.output,M(O);continue}if("slash"===o.type&&"bos"!==o.prev.type&&"/"===e[0]){const t=void 0!==e[1]?"|$":"";H.output=H.output.slice(0,-(o.output+k.output).length),o.output=`(?:${o.output}`,k.type="globstar",k.output=`${$(n)}${A}|${A}${t})`,k.value+=O,H.output+=o.output+k.output,H.globstar=!0,M(O+I()),K({type:"slash",value:"/",output:""});continue}if("bos"===o.type&&"/"===e[0]){k.type="globstar",k.value+=O,k.output=`(?:^|${A}|${$(n)}${A})`,H.output=k.output,H.globstar=!0,M(O+I()),K({type:"slash",value:"/",output:""});continue}H.output=H.output.slice(0,-k.output.length),k.type="globstar",k.output=$(n),k.value+=O,H.output+=k.output,H.globstar=!0,M(O);continue}const o={type:"star",value:O,output:v};!0!==n.bash?!k||"bracket"!==k.type&&"paren"!==k.type||!0!==n.regex?(H.index!==H.start&&"slash"!==k.type&&"dot"!==k.type||("dot"===k.type?(H.output+=h,k.output+=h):!0===n.dot?(H.output+=_,k.output+=_):(H.output+=C,k.output+=C),"*"!==N()&&(H.output+=R,k.output+=R)),K(o)):(o.output=O,K(o)):(o.output=".*?","bos"!==k.type&&"slash"!==k.type||(o.output=C+o.output),K(o))}for(;H.brackets>0;){if(!0===n.strictBrackets)throw new SyntaxError(Y("closing","]"));H.output=j.escapeLast(H.output,"["),U("brackets")}for(;H.parens>0;){if(!0===n.strictBrackets)throw new SyntaxError(Y("closing",")"));H.output=j.escapeLast(H.output,"("),U("parens")}for(;H.braces>0;){if(!0===n.strictBrackets)throw new SyntaxError(Y("closing","}"));H.output=j.escapeLast(H.output,"{"),U("braces")}if(!0===n.strictSlashes||"star"!==k.type&&"bracket"!==k.type||K({type:"maybe_slash",value:"",output:`${A}?`}),!0===H.backtrack){H.output="";for(const t of H.tokens)H.output+=null!=t.output?t.output:t.value,t.suffix&&(H.output+=t.suffix)}return H};J.fastpaths=(t,e)=>{const n={...e},o="number"==typeof n.maxLength?Math.min(X,n.maxLength):X,r=t.length;if(r>o)throw new SyntaxError(`Input length: ${r}, exceeds maximum allowed length: ${o}`);t=z[t]||t;const a=j.isWindows(e),{DOT_LITERAL:s,SLASH_LITERAL:u,ONE_CHAR:i,DOTS_SLASH:p,NO_DOT:c,NO_DOTS:l,NO_DOTS_SLASH:f,STAR:A,START_ANCHOR:R}=Q.globChars(a),y=n.dot?l:c,g=n.dot?f:c,h=n.capture?"":"?:";let _=!0===n.bash?".*?":A;n.capture&&(_=`(${_})`);const E=t=>!0===t.noglobstar?_:`(${h}(?:(?!${R}${t.dot?p:s}).)*?)`,d=t=>{switch(t){case"*":return`${y}${i}${_}`;case".*":return`${s}${i}${_}`;case"*.*":return`${y}${_}${s}${i}${_}`;case"*/*":return`${y}${_}${u}${i}${g}${_}`;case"**":return y+E(n);case"**/*":return`(?:${y}${E(n)}${u})?${g}${i}${_}`;case"**/*.*":return`(?:${y}${E(n)}${u})?${g}${_}${s}${i}${_}`;case"**/.*":return`(?:${y}${E(n)}${u})?${s}${i}${_}`;default:{const e=/^(.*?)\.(\w+)$/.exec(t);if(!e)return;const n=d(e[1]);if(!n)return;return n+s+e[2]}}},b=j.removePrefix(t,{negated:!1,prefix:""});let S=d(b);return S&&!0!==n.strictSlashes&&(S+=`${u}?`),S};const tt=i,et=F,nt=J,ot=f,rt=C,at=(t,e,n=!1)=>{if(Array.isArray(t)){const o=t.map((t=>at(t,e,n))),r=t=>{for(const e of o){const n=e(t);if(n)return n}return!1};return r}const o=(r=t)&&"object"==typeof r&&!Array.isArray(r)&&t.tokens&&t.input;var r;if(""===t||"string"!=typeof t&&!o)throw new TypeError("Expected pattern to be a non-empty string");const a=e||{},s=ot.isWindows(e),u=o?at.compileRe(t,e):at.makeRe(t,e,!1,!0),i=u.state;delete u.state;let p=()=>!1;if(a.ignore){const t={...e,ignore:null,onMatch:null,onResult:null};p=at(a.ignore,t,n)}const c=(n,o=!1)=>{const{isMatch:r,match:c,output:l}=at.test(n,u,e,{glob:t,posix:s}),f={glob:t,state:i,regex:u,posix:s,input:n,output:l,match:c,isMatch:r};return"function"==typeof a.onResult&&a.onResult(f),!1===r?(f.isMatch=!1,!!o&&f):p(n)?("function"==typeof a.onIgnore&&a.onIgnore(f),f.isMatch=!1,!!o&&f):("function"==typeof a.onMatch&&a.onMatch(f),!o||f)};return n&&(c.state=i),c};at.test=(t,e,n,{glob:o,posix:r}={})=>{if("string"!=typeof t)throw new TypeError("Expected input to be a string");if(""===t)return{isMatch:!1,output:""};const a=n||{},s=a.format||(r?ot.toPosixSlashes:null);let u=t===o,i=u&&s?s(t):t;return!1===u&&(i=s?s(t):t,u=i===o),!1!==u&&!0!==a.capture||(u=!0===a.matchBase||!0===a.basename?at.matchBase(t,e,n,r):e.exec(i)),{isMatch:Boolean(u),match:u,output:i}},at.matchBase=(t,e,n,o=ot.isWindows(n))=>(e instanceof RegExp?e:at.makeRe(e,n)).test(tt.basename(t)),at.isMatch=(t,e,n)=>at(e,n)(t),at.parse=(t,e)=>Array.isArray(t)?t.map((t=>at.parse(t,e))):nt(t,{...e,fastpaths:!1}),at.scan=(t,e)=>et(t,e),at.compileRe=(t,e,n=!1,o=!1)=>{if(!0===n)return t.output;const r=e||{},a=r.contains?"":"^",s=r.contains?"":"$";let u=`${a}(?:${t.output})${s}`;t&&!0===t.negated&&(u=`^(?!${u}).*$`);const i=at.toRegex(u,e);return!0===o&&(i.state=t),i},at.makeRe=(t,e={},n=!1,o=!1)=>{if(!t||"string"!=typeof t)throw new TypeError("Expected a non-empty string");let r={negated:!1,fastpaths:!0};return!1===e.fastpaths||"."!==t[0]&&"*"!==t[0]||(r.output=nt.fastpaths(t,e)),r.output||(r=nt(t,e)),at.compileRe(r,e,n,o)},at.toRegex=(t,e)=>{try{const n=e||{};return new RegExp(t,n.flags||(n.nocase?"i":""))}catch(t){if(e&&!0===e.debug)throw t;return/$^/}},at.constants=rt;var st=p(at);function ut(t){return e=t,Array.isArray(e)?t:null==t?[]:[t];var e}const it=function(t){return t.split(i.win32.sep).join(i.posix.sep)};new Set("break case class catch const continue debugger default delete do else export extends finally for function if import in instanceof let new return super switch this throw try typeof var void while with yield enum await implements package protected static interface private public arguments Infinity NaN undefined null true false eval uneval isFinite isNaN parseFloat parseInt decodeURI decodeURIComponent encodeURI encodeURIComponent escape unescape Object Function Boolean Symbol Error EvalError InternalError RangeError ReferenceError SyntaxError TypeError URIError Number Math Date String RegExp Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array Map Set WeakMap WeakSet SIMD ArrayBuffer DataView JSON Promise Generator GeneratorFunction Reflect Proxy Intl".split(" ")).add("");const pt={small:{jpgQuality:30,pngQuality:"20-40"},medium:{jpgQuality:70,pngQuality:"60-80"},large:{jpgQuality:90,pngQuality:"80-100"}},ct=function(t,e,n){const o=n&&n.resolve,r=t=>t instanceof RegExp?t:{test:e=>{const n=function(t,e){if(!1===e||i.isAbsolute(t)||t.startsWith("**"))return it(t);const n=it(i.resolve(e||"")).replace(/[-^$*+?.()|[\]{}]/g,"\\$&");return i.posix.join(n,it(t))}(t,o);return st(n,{dot:!0})(e)}},a=ut(t).map(r),s=ut(e).map(r);return function(t){if("string"!=typeof t)return!1;if(/\0/.test(t))return!1;const e=it(t);for(let t=0;t<s.length;++t){if(s[t].test(e))return!1}for(let t=0;t<a.length;++t){if(a[t].test(e))return!0}return!a.length}}(/\.(png|svg|jpg)$/,void 0,{resolve:!1}),lt=s.clone().use(l).use(u);function ft(t){const e="<svg";return t.toString("utf8",0,4)===e}function At(t,e){const n=(new o.PassThrough).end(t);return new Promise((t=>{lt(n,"when piped through",new r([128,"--quality",`${e}`,"--nofs"]),"to yield output satisfying",lt.it((e=>{t(e)})))}))}return function(o={}){const{size:r="medium"}=o,{jpgQuality:s,pngQuality:u}=pt[r];return{name:"rollup-plugin-imgmin",async generateBundle(o,r){for(const o in r)if(ct(o)){let i=r[o].source;if(!Buffer.isBuffer(i))return;if(ft(i)){Buffer.isBuffer(i)&&(i=i.toString());try{const{data:t}=a.optimize(i);i=Buffer.from(t)}catch(t){console.log(`err--${o}`,t)}}if(t(i)){const t={};i=n(i).encode("jpg",{quality:s,...t})}e(i)&&(i=await At(i,u)),r[o]={...r[o],source:i}}}}}}(isJpg,isPng,images,stream,PngQuant,svgo,unexpected,unexpectedSinon,require$$0$1);
